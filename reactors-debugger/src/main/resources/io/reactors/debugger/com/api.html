
@@library(io/reactors/debugger/js/util.js)
@@library(io/reactors/debugger/lib/jquery/jquery-1.12.4.min.js)


<template id="x-api">
  <div class="x-api-root">
    <!-- config -->
  </div>
</template>


<script>
  "use strict";

  class ApiAdapter {
    constructor(baseUrl) {
      this.baseUrl = baseUrl;
    }

    request(path, payload) {
      var url = this.baseUrl + path;
      var deferred = $.Deferred();
      $.ajax({
        url: url,
        type: "POST",
        contentType: "application/json",
        data: JSON.stringify(payload),
        success: function(data) {
          deferred.resolve(data);
        },
        error: function(r, status, error) {
          deferred.reject(error);
          log.error("Request to '" + url + "' failed.", error);
        }
      });
      return deferred.promise();
    }

    state(suid, timestamp) {
      return this.request("state", {
        suid: suid,
        timestamp: timestamp
      });
    }
  }

  var Api = Vue.extend({
    template: "#x-api",
    props: ["config"],
    data: function() {
      return {
        adapter: new ApiAdapter(this.config.global.baseUrl)
      };
    },
    attached: function() {
    }
  });

  Vue.component("x-api", Api);
</script>
