
@@library(io/reactors/debugger/lib/jquery/jquery-1.12.4.min.js)
@@component(io/reactors/debugger/com/config.html)
@@component(io/reactors/debugger/com/api.html)
@@component(io/reactors/debugger/com/model.html)
@@component(io/reactors/debugger/com/diagram.html)
@@component(io/reactors/debugger/com/log-window.html)


<template id="x-debugger">
  <div class="x-debugger-root">
    <!-- debugger -->
    <x-config v-ref:config>
    </x-config>
    <x-api v-ref:api
      :config="$refs.config.state">
    </x-api>
    <x-model v-ref:model
      :config="$refs.config.state"
      :api="$refs.api.adapter"
      @critical-error="onCriticalError">
    </x-model>
    <x-diagram v-ref:diagram
      :config="$refs.config.state"
      :canvas-class="'x-debugger-diagram'">
    </x-diagram>
    <x-log-window v-ref:log-window
      :config="$refs.config.state"
      :model="$refs.model.history">
    </x-log-window>
  </div>
</template>


<script>
  var Debugger = Vue.extend({
    template: "#x-debugger",
    data: function() {
      return {
        errors: []
      };
    },
    attached: function() {
    },
    methods: {
      onCriticalError: function(msg) {
        this.$refs.model.stop();
        this.errors.push(msg);
      }
    }
  });

  Vue.component("x-debugger", Debugger);
</script>


<style type="text/css">
  .x-debugger-root {
    height: 100%;
    position: relative;
  }

  .x-debugger-diagram {
    position: absolute;
    width: 100%;
    height: 100%;
    z-index: -1;
  }
</style>
