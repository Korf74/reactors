
@@library(io/reactors/debugger/lib/jquery/jquery-1.12.4.min.js)
@@component(io/reactors/debugger/com/config.html)
@@component(io/reactors/debugger/com/api.html)
@@component(io/reactors/debugger/com/model.html)
@@component(io/reactors/debugger/com/diagram.html)
@@component(io/reactors/debugger/com/log-window.html)
@@component(io/reactors/debugger/com/horizontal-tabber.html)
@@component(io/reactors/debugger/com/vertical-tabber.html)
@@style(io/reactors/debugger/css/main.css)


<template id="x-debugger">
  <div class="x-debugger-root">
    <!-- debugger -->
    <x-config v-ref:config>
    </x-config>
    <x-api v-ref:api
      :config="$refs.config.state">
    </x-api>
    <x-model v-ref:model
      :config="$refs.config.state"
      :api="$refs.api.adapter"
      @critical-error="onCriticalError">
    </x-model>
    <x-diagram v-ref:diagram
      :config="$refs.config.state"
      :canvas-class="'x-debugger-diagram'">
    </x-diagram>
    <div class="x-debugger-panel-container">
      <div class="x-debugger-left-panel-container">
        <div class="x-debugger-left-panel">
          <x-vertical-tabber :panels="leftPanelInfo">
          </x-vertical-tabber>
        </div>
      </div>
      <div>
        <div class="x-debugger-bottom-panel">
          <x-horizontal-tabber :panels="bottomPanelInfo">
            <x-log-window v-ref:log-window
              slot="0"
              :config="$refs.config.state"
              :model="$refs.model.history">
            </x-log-window>
          </x-horizontal-tabber>
        </div>
      </div>
    </div>
  </div>
</template>


<script>
  var Debugger = Vue.extend({
    template: "#x-debugger",
    data: function() {
      return {
        errors: [],
        leftPanelInfo: [
          {
            icon: "<span class='glyphicon glyphicon-pause'></span>",
          }
        ],
        bottomPanelInfo: [
          {
            icon: "<span class='glyphicon glyphicon-list-alt'></span>",
            text: "Log"
          },
          {
            icon: "<span class='glyphicon glyphicon-record'></span>",
            text: "Breakpoints"
          }
        ]
      };
    },
    attached: function() {
    },
    methods: {
      onCriticalError: function(msg) {
        this.$refs.model.stop();
        this.errors.push(msg);
      }
    }
  });

  Vue.component("x-debugger", Debugger);
</script>


<style type="text/css">
  .x-debugger-root {
    height: 100%;
    position: relative;
  }

  .x-debugger-diagram {
    position: absolute;
    width: 100%;
    height: 100%;
    z-index: -1;
  }

  .x-debugger-bottom-panel {
    position: fixed;
    bottom: 0;
    width: 100%;
    padding: 6px;
  }

  .x-debugger-panel-container {
    height: 100%;
  }

  .x-debugger-left-panel-container {
    height: 100%;
  }

  .x-debugger-left-panel {
    height: 100%;
  }
</style>
